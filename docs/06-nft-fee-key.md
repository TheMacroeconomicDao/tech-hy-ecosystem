# NFT Fee Key

## Характеристики
- **Получение**: При блокировке LP токенов в "Burn and Earn"
- **Назначение**: Получение части налога с транзакций VG (10%)
- **Передаваемость**: Может быть продан или передан другому пользователю

## Уровни NFT
| Уровень   | LP токены | Множитель |
|-----------|-----------|-----------|
| Common    | < 1,000   | 1.0x      |
| Rare      | 1K - 10K  | 1.2x      |
| Epic      | 10K - 100K| 1.5x      |
| Legendary | > 100K    | 2.0x      |

## Метаданные NFT
- **Название**: VC/VG Fee Key #{id}
- **Символ**: VCFK
- **Атрибуты**:
  - `locked_lp_amount`: Количество заблокированных LP
  - `lock_timestamp`: Время блокировки (Unix timestamp)
  - `fee_share_percentage`: Процент от общего пула комиссий
  - `tier`: Уровень NFT (Common, Rare, Epic, Legendary)

## Расчет доли в комиссиях
```
share_percentage = (user_locked_lp * tier_multiplier) / total_weighted_locked_lp * 100%
```

## Технические аспекты реализации

### Структуры данных
1. **Аккаунт NFT Fee Key**:
   - Владелец
   - Количество заблокированных LP
   - Временная метка блокировки
   - Процент доли в пуле комиссий
   - Уровень NFT (1-4)
   - Временная метка последнего сбора вознаграждения
   - Общая сумма собранного вознаграждения
   - Бамп для PDA

2. **Хранилище распределения комиссий**:
   - Адрес управляющего
   - Адрес токен-аккаунта
   - Общая сумма собранных комиссий
   - Общая сумма распределенных комиссий
   - Временная метка последнего распределения
   - Бамп для PDA

### Ключевые функции
1. **Создание NFT Fee Key**:
   - Определение уровня NFT
   - Расчет доли в пуле комиссий
   - Инициализация аккаунта
   - Создание NFT через Metaplex

2. **Сбор вознаграждения**:
   - Проверка владения NFT
   - Расчет накопленного вознаграждения
   - Перевод на кошелек пользователя
   - Обновление состояния

3. **Обновление долей в пуле**:
   - Пересчет при изменении общего количества заблокированных LP токенов
   - Обновление `total_weighted_locked_lp`
   - Актуализация долей для каждого NFT 