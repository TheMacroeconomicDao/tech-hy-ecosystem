# NFT Fee Key

## Обзор

NFT Fee Key - это невзаимозаменяемый токен (NFT), который выдается пользователю при конвертации VC токенов в LP токены с последующей постоянной блокировкой в механизме "Burn and Earn". NFT Fee Key дает право на получение части комиссий, собираемых с транзакций VG токенов.

## Основные характеристики

- **Получение**: При блокировке LP токенов в механизме "Burn and Earn"
- **Назначение**: Получение дохода от комиссий, взимаемых с транзакций VG токенов
- **Возможность передачи**: Может быть передан другому пользователю или продан на маркетплейсе NFT
- **Ценность**: Определяется количеством заблокированных LP токенов и уровнем NFT

## Уровни NFT Fee Key

NFT Fee Key имеет четыре уровня в зависимости от количества заблокированных LP токенов:

| Уровень | Количество LP токенов | Множитель дохода |
|---------|------------------------|-------------------|
| Common  | < 1,000                | 1.0x              |
| Rare    | 1,000 - 10,000         | 1.2x              |
| Epic    | 10,000 - 100,000       | 1.5x              |
| Legendary| > 100,000              | 2.0x              |

Чем выше уровень NFT Fee Key, тем больший множитель применяется при расчете доли в пуле комиссий, что увеличивает доход владельца NFT.

## Метаданные NFT Fee Key

Каждый NFT Fee Key содержит следующие метаданные:

- **Название**: VC/VG Fee Key #{id}
- **Символ**: VCFK
- **Описание**: Этот NFT дает право на получение части комиссий, генерируемых в экосистеме VC/VG. Процент дохода пропорционален количеству заблокированных LP токенов.
- **Изображение**: Уникальное изображение, генерируемое на основе количества заблокированных LP токенов и времени блокировки
- **Атрибуты**:
  - `locked_lp_amount`: Количество заблокированных LP токенов
  - `lock_timestamp`: Время блокировки (Unix timestamp)
  - `fee_share_percentage`: Процент от общего пула комиссий
  - `tier`: Уровень NFT (Common, Rare, Epic, Legendary)

## Распределение комиссий

Комиссии, собираемые с транзакций VG токенов (10% от суммы), распределяются следующим образом:

1. 50% направляется в пул для держателей NFT Fee Key
2. 30% используется для обратного выкупа и сжигания VC токенов
3. 20% направляется в казну DAO для развития экосистемы

Доля каждого держателя NFT Fee Key в пуле комиссий рассчитывается по формуле:

```
share_percentage = (user_locked_lp * tier_multiplier) / total_weighted_locked_lp * 100%
```

Где:
- `user_locked_lp` - количество LP токенов, заблокированных пользователем
- `tier_multiplier` - множитель в зависимости от уровня NFT
- `total_weighted_locked_lp` - сумма всех заблокированных LP токенов с учетом множителей

## Процесс сбора вознаграждения

Держатели NFT Fee Key могут собирать накопленное вознаграждение в любое время, выполнив следующие шаги:

1. Вызов функции сбора вознаграждения
2. Проверка владения NFT Fee Key
3. Расчет накопленного вознаграждения на основе доли в пуле комиссий
4. Перевод вознаграждения в SOL на кошелек пользователя
5. Обновление статистики сбора вознаграждения

## Техническая реализация

### Структуры данных

В системе используются следующие основные структуры данных:

#### Аккаунт NFT Fee Key
Хранит информацию о конкретном NFT Fee Key, включая:
- Владелец
- Количество заблокированных LP токенов
- Временная метка блокировки
- Процент доли в пуле комиссий
- Уровень NFT (1 - Common, 2 - Rare, 3 - Epic, 4 - Legendary)
- Временная метка последнего сбора вознаграждения
- Общая сумма собранного вознаграждения
- Бамп для PDA

#### Хранилище распределения комиссий
Содержит информацию о хранилище комиссий:
- Адрес управляющего
- Адрес токен-аккаунта
- Общая сумма собранных комиссий
- Общая сумма распределенных комиссий
- Временная метка последнего распределения
- Бамп для PDA

### Создание NFT Fee Key

Процесс создания NFT Fee Key включает:
- Определение уровня NFT в зависимости от количества заблокированных LP токенов
- Расчет множителя в зависимости от уровня
- Определение доли в пуле комиссий
- Инициализацию аккаунта NFT Fee Key
- Создание NFT с использованием Metaplex с указанием соответствующих метаданных

### Сбор вознаграждения

Процесс сбора вознаграждения включает:
- Проверку владения NFT Fee Key
- Расчет накопленного вознаграждения на основе доли в пуле комиссий
- Перевод вознаграждения на кошелек пользователя
- Обновление состояния аккаунта NFT Fee Key и хранилища распределения комиссий

### Обновление доли в пуле комиссий

При изменении общего количества заблокированных LP токенов (например, когда кто-то блокирует новые LP токены), необходимо пересчитать доли всех держателей NFT Fee Key. Это делается через механизм периодического обновления, который включает:
- Вычисление общего количества взвешенных LP токенов
- Обновление общего количества взвешенных LP токенов в хранилище
- Пересчет долей для каждого NFT Fee Key на основе нового общего количества

## Экономический механизм

NFT Fee Key создает экономическую ценность для участников экосистемы через:

1. **Постоянный доход**: Держатели NFT Fee Key получают постоянный доход от комиссий с транзакций VG токенов, что стимулирует долгосрочное участие.

2. **Ценность NFT**: NFT Fee Key имеет внутреннюю ценность, определяемую его долей в пуле комиссий, что создает вторичный рынок для этих NFT.

3. **Стимулирование блокировки LP токенов**: Система уровней и множителей стимулирует пользователей блокировать большие объемы LP токенов для получения NFT Fee Key высокого уровня.

4. **Циркуляция VC токенов**: Часть комиссий используется для обратного выкупа и сжигания VC токенов, что создает дополнительный спрос на VC токены и поддерживает их ценность.

## Интерфейс пользователя

Для удобства пользователей реализуется веб-интерфейс, который позволяет:

1. Просматривать информацию о своих NFT Fee Key
2. Видеть текущий уровень и долю в пуле комиссий
3. Отслеживать накопленное вознаграждение
4. Собирать вознаграждение
5. Просматривать историю полученных вознаграждений

## Заключение

NFT Fee Key является ключевым элементом экосистемы VC/VG токенов, обеспечивающим долгосрочную заинтересованность пользователей и создающим устойчивую экономическую модель. Через систему уровней и распределение комиссий NFT Fee Key стимулирует блокировку LP токенов и участие в развитии экосистемы. 