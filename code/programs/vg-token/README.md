# VG Token (TECH-HY Governance Token)

Governance SPL токен TECH-HY экосистемы с налогом 10% на транзакции.

## Технические характеристики

- **Тип**: Модифицированный SPL Token (соответствует стандарту SPL Token Interface)
- **Эмиссия**: 1,000,000,000 VG (поэтапная через механизм Burn and Earn)
- **Десятичные знаки**: 9
- **Налог на транзакции**: 10% от всех переводов токена
- **Распределение налога**: 
  - 50% держателям NFT Fee Key
  - 50% казне DAO
- **Mint Authority**: Программа Burn and Earn (PDA)
- **Freeze Authority**: Мультисиг DAO (3/5 подписей)

## Особенности реализации

1. **Налог 10% на транзакции** - С каждой транзакции перевода токенов VG удерживается 10% налог, который распределяется между держателями NFT Fee Key и казной DAO.

2. **Поэтапная эмиссия** - Токены VG не выпускаются сразу полностью, а генерируются постепенно через механизм Burn and Earn при конвертации VC токенов в LP токены.

3. **Интеграция с NFT Fee Key** - 50% собранного налога направляется держателям NFT Fee Key, что создает пассивный доход для этих держателей.

4. **Контроль безопасности** - Только мультисиг DAO имеет права на замораживание аккаунтов, что обеспечивает децентрализованное управление и защиту от произвола.

5. **Метаданные** - Интеграция с Metaplex для установки метаданных токена (имя, символ, URI).

## Инструкции

Контракт предоставляет следующие инструкции:

### 1. `initialize`

Инициализирует новый VG токен без начальной эмиссии.

**Аккаунты**:
- `payer`: Аккаунт, оплачивающий комиссии транзакции
- `mint`: PDA аккаунт минта токена
- `token_program`: Программа SPL Token или Token 2022
- `system_program`: Системная программа

### 2. `mint_tokens`

Выпускает новые VG токены. Может быть вызвана только авторизованной программой Burn and Earn.

**Параметры**:
- `amount`: Количество токенов для выпуска

**Аккаунты**:
- `payer`: Аккаунт, оплачивающий комиссии транзакции
- `recipient`: Аккаунт получателя новых токенов
- `mint`: PDA аккаунт минта токена
- `recipient_token_account`: Токен-аккаунт получателя
- `token_program`: Программа SPL Token или Token 2022
- `associated_token_program`: Программа Associated Token для создания токен-аккаунтов
- `system_program`: Системная программа

### 3. `transfer`

Переводит VG токены с удержанием 10% налога и его распределением.

**Параметры**:
- `amount`: Количество токенов для перевода

**Аккаунты**:
- `sender`: Отправитель токенов
- `recipient`: Получатель токенов
- `dao_treasury`: Аккаунт казны DAO для получения части налога
- `fee_collector`: Аккаунт коллектора комиссий для держателей NFT Fee Key
- `mint`: PDA аккаунт минта токена
- `sender_token_account`: Токен-аккаунт отправителя
- `recipient_token_account`: Токен-аккаунт получателя
- `dao_treasury_token_account`: Токен-аккаунт казны DAO
- `fee_collector_token_account`: Токен-аккаунт коллектора комиссий
- `token_program`: Программа SPL Token или Token 2022
- `associated_token_program`: Программа Associated Token для создания токен-аккаунтов
- `system_program`: Системная программа

### 4. `set_metadata`

Устанавливает метаданные для токена с помощью Metaplex.

**Параметры**:
- `name`: Имя токена (например, "TECH-HY Governance Token")
- `symbol`: Символ токена (например, "VG")
- `uri`: URI для метаданных токена (JSON файла с дополнительной информацией)

**Аккаунты**:
- `authority`: Аккаунт с правами на установку метаданных
- `mint`: PDA аккаунт минта токена
- `metadata`: PDA аккаунт метаданных от Metaplex
- `payer`: Аккаунт, оплачивающий комиссии транзакции
- `metadata_program`: Программа Metaplex Token Metadata
- `system_program`: Системная программа
- `rent`: Системный вызов для расчёта арендной платы

### 5. `set_freeze_authority`

Устанавливает авторитет для замораживания токенов. Может быть вызвана только мультисигом DAO.

**Аккаунты**:
- `payer`: Аккаунт, оплачивающий комиссии транзакции
- `mint`: PDA аккаунт минта токена
- `dao_authority`: Адрес мультисиг DAO, который получит права на замораживание
- `token_program`: Программа SPL Token или Token 2022
- `system_program`: Системная программа

## Формула расчета налога

Налог рассчитывается по формуле:

```
tax_amount = amount * TAX_RATE_BPS / 10000
transfer_amount = amount - tax_amount

dao_tax_amount = tax_amount * DAO_SHARE_BPS / (DAO_SHARE_BPS + NFT_HOLDERS_SHARE_BPS)
nft_holders_tax_amount = tax_amount - dao_tax_amount
```

где:
- `amount` - исходная сумма перевода
- `TAX_RATE_BPS` = 1000 (10% в базисных пунктах, где 10000 = 100%)
- `DAO_SHARE_BPS` = 500 (50% от налога)
- `NFT_HOLDERS_SHARE_BPS` = 500 (50% от налога)

## Разработка и тестирование

### Установка зависимостей
```bash
npm install
```

### Сборка контракта
```bash
anchor build
```

### Запуск тестов
```bash
anchor test
```

## Безопасность

Контракт разработан с учетом следующих аспектов безопасности:
- Прозрачный и неизменяемый механизм расчета и распределения налога
- Защита от атак повторного входа при переводах токенов
- Использование PDA для минта, что обеспечивает безопасные подписи транзакций
- Децентрализованное управление функцией замораживания аккаунтов через мультисиг DAO
- Проверки авторизации для критических операций (минтинг, установка авторитетов)

## Интеграции

VG токен интегрируется со следующими компонентами экосистемы TECH-HY:
- **NFT Fee Key**: Получает 50% налога для распределения между держателями NFT
- **Burn and Earn**: Имеет права на минтинг новых VG токенов
- **Governance (DAO)**: Управляет freeze authority и получает 50% налога в казну 