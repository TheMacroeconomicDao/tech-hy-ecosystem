# Руководство по разработке экосистемы TECH-HY на Solana

## Обзор экосистемы

Экосистема TECH-HY представляет собой многоуровневую токеномическую систему на блокчейне Solana, состоящую из следующих ключевых компонентов:

1. **VC Token** - базовый SPL токен без налога ([Tasks](./vc-token/TASKS.md))
2. **VG Token** - governance SPL токен с налогом 10% ([Tasks](./vg-token/TASKS.md))
3. **Burn and Earn** - механизм конвертации VC в LP и эмиссии VG ([Tasks](./burn-and-earn/TASKS.md))
4. **VC Staking** - система стейкинга VC с созданием NFT-бустеров ([Tasks](./vc-staking/TASKS.md))
5. **NFT Investor's Hand** - коллекция NFT бустеров для увеличения доходности ([Tasks](./nft-investors-hand/TASKS.md))
6. **VG Staking** - система стейкинга VG с многоуровневой структурой ([Tasks](./vg-staking/TASKS.md))
7. **NFT Fee Key** - NFT для получения доли комиссий с транзакций VG ([Tasks](./nft-fee-key/TASKS.md))
8. **Governance (DAO)** - система децентрализованного управления экосистемой ([Tasks](./governance/TASKS.md))

## Взаимосвязи между компонентами

```
                     +---------------+
                     |               |
                     |  VC Token     |
                     |               |
                     +-------+-------+
                             |
                             v
         +------------------+------------------+
         |                  |                  |
+--------v--------+ +-------v--------+ +-------v--------+
|                 | |                | |                |
| VC Staking      | | Burn and Earn  | | VG Token       |
|                 | |                | |                |
+--------+--------+ +-------+--------+ +-------+--------+
         |                  |                  |
         v                  v                  v
+--------+--------+ +-------+--------+ +-------+--------+
|                 | |                | |                |
| NFT Investor's  | | NFT Fee Key    | | VG Staking     |
| Hand            | |                | |                |
|                 | |                | |                |
+--------+--------+ +-------+--------+ +-------+--------+
         |                  |                  |
         +------------------+------------------+
                           |
                           v
                  +--------+--------+
                  |                 |
                  | Governance      |
                  | (DAO)           |
                  |                 |
                  +-----------------+
```

## Порядок разработки

Разработку следует вести в следующем порядке, учитывая зависимости и сложность компонентов:

### Этап 1: Базовые токены
1. **VC Token** - базовый токен без налога
2. **VG Token** - токен с налогом 10%

### Этап 2: Первичная интеграция и механизмы
3. **Burn and Earn** - механизм конвертации VC в LP
4. **VC Staking** - система стейкинга VC

### Этап 3: NFT компоненты
5. **NFT Investor's Hand** - коллекция NFT бустеров
6. **NFT Fee Key** - NFT для получения комиссий

### Этап 4: Финальная интеграция
7. **VG Staking** - система стейкинга VG с многоуровневой структурой
8. **Governance (DAO)** - система управления экосистемой

## Технические характеристики токенов

### VC Token
- **Тип**: SPL Token
- **Налог**: 0%
- **Десятичные знаки**: 9
- **Общая эмиссия**: 5,000,000,000 VC
- **Mint Authority**: Мультисиг DAO (3/5 подписей)
- **Freeze Authority**: Отсутствует после инициализации

### VG Token
- **Тип**: Модифицированный SPL Token (SPL22)
- **Налог**: 10% от всех транзакций
- **Десятичные знаки**: 9
- **Общая эмиссия**: 1,000,000,000 VG
- **Распределение налога**: 50% держателям NFT Fee Key, 50% казне DAO
- **Mint Authority**: Программа Burn and Earn (PDA)
- **Freeze Authority**: Мультисиг DAO (3/5 подписей)

## Детальный план действий

### 1. Подготовка среды разработки
- Установить Rust, Solana CLI, Anchor
- Настроить локальную тестовую сеть
- Создать необходимые ключи и аккаунты для тестирования

### 2. Разработка VC токена
- Реализовать базовую структуру SPL токена
- Разработать функции mint, transfer, burn
- Интегрировать с Metaplex для метаданных
- Обеспечить полное тестирование

### 3. Разработка VG токена
- Реализовать SPL токен с модификацией для налога 10%
- Разработать механизм распределения налога (50% NFT Fee Key, 50% казна DAO)
- Интегрировать с Metaplex для метаданных
- Обеспечить полное тестирование

### 4. Разработка механизма Burn and Earn
- Исследовать и интегрироваться с Raydium API
- Реализовать конвертацию VC в LP токены
- Реализовать постоянную блокировку LP
- Разработать формулу эмиссии VG: `VG = LP * C * (1 + B * log10(LP/LP_min))`, где:
  - `LP` - количество заблокированных LP токенов
  - `C` - базовый коэффициент (C = 10)
  - `B` - бонусный коэффициент (B = 0.2)
  - `LP_min` - минимальное количество LP (LP_min = 1)
- Обеспечить полное тестирование

### 5. Разработка VC Staking
- Реализовать блокировку 1 млн VC на 90 дней
- Подготовить механизм создания NFT-бустеров
- Реализовать функционал вывода токенов по истечении периода
- Обеспечить полное тестирование

### 6. Разработка NFT Investor's Hand
- Исследовать и интегрироваться с Metaplex NFT Standard
- Реализовать создание NFT разных уровней с соответствующими метаданными
- Разработать логику проверки NFT для получения бустов
- Обеспечить полное тестирование

### 7. Разработка NFT Fee Key
- Реализовать создание NFT четырех уровней
- Разработать механизм распределения комиссий между держателями
- Интегрировать с VG токеном для получения налога
- Интегрировать с Burn and Earn для создания NFT
- Обеспечить полное тестирование

### 8. Разработка VG Staking
- Реализовать многоуровневую систему стейкинга
- Разработать механизм применения NFT-бустеров
- Реализовать автоматическое реинвестирование
- Интегрировать с системой DAO для уровней доступа
- Обеспечить полное тестирование

### 9. Разработка Governance (DAO)
- Исследовать и интегрироваться с Realms
- Реализовать уровни доступа в зависимости от стейкинга
- Разработать механизмы создания предложений и голосования
- Реализовать управление казной DAO
- Реализовать аварийное управление с мультисигнатурой
- Обеспечить полное тестирование

## Критические точки интеграции

### VC Token → Burn and Earn
- Передача VC токенов для конвертации в LP
- Сжигание VC для формирования пула ликвидности

### VC Token → VC Staking
- Блокировка 1 млн VC на 90 дней
- Проверка баланса VC для стейкинга

### VC Staking → NFT Investor's Hand
- Создание NFT уровня Wooden Hand при стейкинге 1 млн VC
- Передача информации о стейкинге для метаданных NFT

### Burn and Earn → VG Token
- Эмиссия VG токенов по формуле
- Распределение VG токенов пользователю

### Burn and Earn → NFT Fee Key
- Создание NFT Fee Key соответствующего уровня
- Передача информации о заблокированных LP для метаданных NFT

### VG Token → NFT Fee Key
- Передача части налога держателям NFT Fee Key
- Обновление размера накопленных комиссий

### VG Token → Governance (DAO)
- Передача части налога в казну DAO
- Проверка баланса VG для голосования и создания предложений

### NFT Investor's Hand → VG Staking
- Применение множителя в зависимости от уровня NFT
- Расчет эффективной доли в пуле вознаграждений

### VG Staking → Governance (DAO)
- Non-tradable Governance Token
- Определение уровня доступа к DAO
- Синхронизация периодов стейкинга и прав пользователя

## Важные аспекты безопасности

### 1. Защита от reentrancy атак
- Использовать принцип checks-effects-interactions
- Применять reentrancy-guard где необходимо

### 2. Проверка переполнения и арифметические операции
- Использовать безопасные математические операции
- Применять проверки переполнения

### 3. Контроль доступа
- Реализовать строгое разграничение прав
- Проверять подписи всех критических операций

### 4. Безопасность интеграций
- Проверять результаты всех внешних вызовов
- Использовать корректную обработку ошибок

### 5. Защита от манипуляций временем
- Использовать системное время Solana для временных меток
- Проверять валидность временных периодов

## Стратегия тестирования

### 1. Модульные тесты
- Тестирование отдельных функций каждого компонента
- Проверка граничных случаев и обработки ошибок

### 2. Интеграционные тесты
- Тестирование взаимодействия между компонентами
- Проверка корректности передачи данных между программами

### 3. Системные тесты
- Тестирование системы целиком в локальной среде
- Симуляция различных пользовательских сценариев

### 4. Тестирование в devnet
- Тестирование в реальных условиях тестовой сети
- Проверка интеграций с внешними протоколами

### 5. Стресс-тестирование
- Проверка работы под высокой нагрузкой
- Тестирование устойчивости к сбоям

## Потенциальные проблемы и решения

### 1. Сложность интеграции с Raydium
- **Проблема**: API может измениться или иметь ограничения
- **Решение**: Создать адаптеры и мок-интерфейсы для тестирования

### 2. Ограничения вычислительных единиц
- **Проблема**: Транзакции могут превышать лимит CU Solana
- **Решение**: Оптимизировать код и разбивать сложные операции

### 3. Безопасность NFT
- **Проблема**: Возможна подделка или дублирование NFT
- **Решение**: Внедрить надежную проверку подлинности и владения

### 4. Расчеты с плавающей точкой
- **Проблема**: Solana не поддерживает плавающую точку напрямую
- **Решение**: Использовать фиксированную точку и масштабирование

### 5. Управление состоянием DAO
- **Проблема**: Сложность обновления системы при принятых предложениях
- **Решение**: Реализовать программное выполнение решений DAO

## Заключение и рекомендации

1. Начинайте с самых базовых компонентов, затем переходите к более сложным
2. Внимательно следите за взаимозависимостями между программами
3. Тестируйте каждый компонент тщательно перед интеграцией
4. Документируйте API и интерфейсы взаимодействия между компонентами
5. Обеспечьте аудит безопасности для всех критических компонентов
6. Следуйте лучшим практикам разработки программ на Solana
7. Регулярно тестируйте всю систему целиком

## Инструкции по запуску тестовой среды

```bash
# Запуск локального валидатора Solana
solana-test-validator

# Сборка программ
anchor build

# Деплой программ в локальную сеть
anchor deploy

# Запуск тестов
anchor test
```

## Дополнительные ресурсы

- [Документация TECH-HY](https://tech-hy-venture-club.gitbook.io/tech-hy-venture-club-white-paper)

- [Документация Solana](https://docs.solana.com/)
- [Документация Anchor](https://www.anchor-lang.com/)
- [Документация Metaplex](https://docs.metaplex.com/)
- [Документация Raydium](https://raydium.gitbook.io/raydium/)
- [Документация Realms](https://realms.gitbook.io/realms/) 